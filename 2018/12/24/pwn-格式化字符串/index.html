<!doctype html>
<html lang="en">
<head>
    <head>
    <!-- Require Meta -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <!-- Font-awsome CSS-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <!-- hightlight.js -->
    <link rel="stylesheet" href="/css/style.css">
    <link type="icon" href="/images/favicon.ico">
    <!-- title -->
    <title>y4ngyy</title>
</head>
</head>
<body>
<div class="sidebar-container">
<div class="sidebar rounded">
    <!--头像区域-->
    <div class="head bg-dark text-center rounded-bottom">
        <a href="#">
            <img src="/images/avatar.jpg" alt="avatar.jpg">
        </a>
        <h2 class="text-light mt-4">y4ngyy</h2>
    </div>
    <!--个人描述-->
    <section class="text-center text-dark p-lg-5 p-3" id="description"><h4 class="m-0">无所事事,游手好闲</h4></section>
    <!--导航条-->
    <nav>
        <p  class="nav-clapse fa fa-bars text-center"></p>
        <ul class="nav flex-column text-center">
            
            <li class="nav-item">
                <a href="/" class="nav-link text-secondary">Home</a>
            </li>
            
            <li class="nav-item">
                <a href="/archives" class="nav-link text-secondary">Archives</a>
            </li>
            
        </ul>
    </nav>
</div>
</div>
<div class="content-container">
    <div class="content shadow rounded">
        <h2 class="text-center">【PWN】格式化字符串</h2>
        <div class="text-center">
            <i class="fa fa-calendar"></i>
            <span>2018-12-24</span>
        </div>
        <hr width="90%" color="#ddd">
        <article>
                <p>C语言中经常使用<code>scanf</code>和<code>pringtf</code>进行格式化的读入和输出，但是没有做好过滤可能导致程序漏洞。</p>
<h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><p>通常C语言中的占位符有如下：</p>
<table>
<thead>
<tr>
<th>占位符</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>%p</td>
<td>以16进制输出指针的值（地址）</td>
</tr>
<tr>
<td>%x</td>
<td>输出16进制值（与%p有区别）</td>
</tr>
<tr>
<td>%s</td>
<td>输出字符串值</td>
</tr>
<tr>
<td>%d</td>
<td>输出10进制整数</td>
</tr>
<tr>
<td>%n</td>
<td>占位符前面成功输入的字符个数写入变量中</td>
</tr>
</tbody>
</table>
<p>用<code>%number$p</code>可以指定后number个参数输出。</p>
<h2 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h2><p>若程序中直接使用<code>printf(str)</code>，且<code>str</code>我们可以控制，则在str中输入格式化字符串，可以泄露出栈内容，且可以进行任意地址写。<br><strong>利用方式</strong>:</p>
<ol>
<li>泄露出栈中内容，找到栈中str的位置（利用%number$x）进行探查。</li>
<li>构造payload<code>地址+填充字符+%number$n</code>可以任意地址写入内容。</li>
</ol>

        </article>
        <hr width="90%" color="#ddd">
    </div>
    <div class="content text-center mb-2"><span>Powered By Hexo | theme: <a href="y4ngyy.xyz">y4ngyy</a></span></div>
<script
        src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
<script src="/js/highlight.pack.js"></script>
<script src="/js/nav.js"></script>
<script>
    $(document).ready(function() {
        $('figure').each(function(i, block) {
            hljs.highlightBlock(block);
        });
    });
</script>
</div>
</body>
</html>